\chapter{Fortran90の基礎２〜繰り返し処理とグラフ描画〜}
\section{繰り返し処理}
\subsection*{$<$演習課題$>$}
以下で表されるフィボナッチ数列$a_k$について、$k=1,2, \cdots, 10$の値を画面に表示するプログラムを作成せよ。 \\
\begin{eqnarray}
a_0 &=& 1 \\
a_1 &=& 1 \\
a_{k+2} &=& a_{k+1} + a_k
\end{eqnarray}

以下に解答例を示す。
%TODO よくない解答例を示す。
この例では、10回同じ計算をソースコードに記述している。
しかし、繰り返し回数がさらに多くなってくると、ソースコードにすべて記述するのは現実的でない。

多くのプログラム言語には、このような同じ処理を繰り返し行うための枠組みが用意されている。
Fortranの場合、{\ttfamily do}ループと呼ばれる仕組みで実現できる。

以下に、フィボナッチ数列を{\ttfamily do}ループにより計算し、画面に表示するプログラムを示す。

%TODO フィボナッチ数列の例に変える。
\lstinputlisting[caption={繰り返し処理を用いたフィボナッチ数列の計算. }, label=doloop]{source/2/DoLoop.f90}

\subsection*{$<$演習課題$>$}
$k=1,2, \cdots, 20$について、関数$f(k) = k!$の値を画面表示させるプログラムを作成せよ。\\
なお$k!$は、以下の階乗を表す。
\begin{eqnarray}
k! = \prod_{n=1}^{k} n
\end{eqnarray}

%\lstinputlisting[caption={総和. }, label=summation]{source/2/Summation.f90}

\section{ファイル出力とグラフ描画}
以上の例では、計算された値が画面に出力されるだけなので、その計算結果の様子がつかみにくい。
計算結果をグラフ化することで、その結果を効果的に理解することが可能となる。

計算結果をグラフ化するため、以下の項目を学習する。
\begin{enumerate}
	\item 計算結果をファイルへ出力する。
	\item 結果が格納されたファイルを読み取り、その結果をグラフ化する。
\end{enumerate}

\subsection*{ファイル出力}
上のプログラムに少し手を加えて, 計算結果をファイルに出力するように変更したものが以下である.
%TODO Fibonacci数列の計算に変更する。
\lstinputlisting[caption=ファイル出力. , label=fileFibonacci]{source/1/FileOutput.f90}
open文を用いて装置番号1のファイル``output.dat"を開いておき,
write文で書き出す際には装置番号1を指定している
\footnote{
  なお, 装置番号は5(標準入力)と6(標準出力)を除く1から99までの任意の数を指定することができる.
}
.
プログラムを実行し, ``output.dat"というファイルが作成され, その中に
フィボナッチ数列の計算結果が100個出力されていることを確認せよ。
\\


\subsection*{グラフ描画入門}
[グラフ描画の説明]

\subsection*{$<$演習課題$>$}
$k=1,2, \cdots, 20$について、関数$f(k) = k!$の値をプロットせよ。

\subsection*{$<$演習課題$>$}
%物理学実験で用いる少し複雑な関数のプロット
以下のエアリー関数をプロットせよ。
\begin{eqnarray}
%TODO エアリー関数に変更
k! = \prod_{n=1}^{k} n
\end{eqnarray}
なお、エアリー関数は矩形開口を平面波が通過した時にできる回折パターンを示すもので、
物理学実験の課題＊＊にも用いられている。
%TODO x、yを離散的に計算しないといけないことを書く。
なお、上式の$x$は＊＊＊、$y$は＊＊＊として計算せよ。

\subsection*{$<$応用問題$>$}
\subsubsection{ジャパニーズ・アトラクタ}
ジャパニーズ・アトラクタは次式の微分方程式で表されるもので、
$k=0.1, B=12.0$のとき解がカオス系を示すことで知られている。
\begin{eqnarray}
  \frac{\mathrm{d}x}{\mathrm{d}t} &=& y\\
  \frac{\mathrm{d}y}{\mathrm{d}t} &=& -kx - x^3 + B \cos t\\
\end{eqnarray}
この微分方程式で表される$x$と$y$の軌道を差分法により解き、グラフにプロットせよ。
以下に、ヒントとなるソースコードの一部を示す。

%TODO ジャパニーズ・アトラクタのソースコードを一部白抜きで示す。
